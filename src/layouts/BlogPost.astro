---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
 

 export interface Props {
	content: {
		title: string;
		description: string;
		publishDate: string;
		heroImage?: {
			src: string;
			alt: string;
		};
	}
}

const { 	content: { title, description, publishDate, heroImage },   	} = Astro.props as Props;

let allPosts = await Astro.glob('../pages/posts/**/*.md');
allPosts = allPosts
  .filter(post => !post.frontmatter.draft)
  .sort((a, b) =>
    new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf()
);
let postsNumber = allPosts.length;
const thisUrl = new URL(Astro.request.url);
let nextUrl, nextTitle, prevUrl, prevTitle, addSlash = "";
for(let x = 0; x < postsNumber; x++) {
  if(thisUrl.pathname + addSlash === allPosts[x].url){
    // console.log(allPosts[x].url);
    if (x > 0) {
      nextUrl = allPosts[x-1].url;
      nextTitle = allPosts[x-1].frontmatter.title;
    }
    if (x < postsNumber - 1) {
      prevUrl = allPosts[x+1].url;
      prevTitle = allPosts[x+1].frontmatter.title;
    }
  }
}
 
---

<html>
	<head>
		<BaseHead title={title} description={description} />
	</head>

	<body>
		<Header />
		<article class="wrapper content">
			<header>
				{heroImage && (
					<img
						width="720"
						height="420"
						loading="lazy"
						src={heroImage.src}
						alt={heroImage.alt}
					/>
				)}
				<h1 class="title bg-red-500">{title}</h1>
				<time>{publishDate}</time>
			</header>
			<main>
				<slot></slot>

				{nextTitle &&
					<p class="ctr prevnextP">
					  Next: <a class="next" href={nextUrl}>{nextTitle}</a>
					</p>
				  }
				  {prevTitle &&
					<p class="ctr prevnextP">
					  Previous: <a class="previous" href={prevUrl}>{prevTitle}</a>
					</p>
				  }
			</main>
 		</article>
	</body>
</html>











<style>
 
	.title {
		font-size: 2.25rem;
		font-weight: 700;
	}
</style>
